<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenClaw Pages</title>
  <meta name="description" content="문서/정리 HTML 모음. 공유할 때는 이 사이트의 URL만 보내면 됨." />
  <style>
    :root { --fg:#1f2937; --muted:#64748b; --bg:#f8fafc; --card:#ffffff; --border:#e2e8f0; --link:#2563eb; }
    html,body { margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:-apple-system,BlinkMacSystemFont,"Apple SD Gothic Neo","Noto Sans KR",Segoe UI,Roboto,Arial,sans-serif; line-height:1.55; }
    main { max-width: 980px; margin: 24px auto; padding: 0 16px; }
    a { color:var(--link); text-decoration:none; }
    a:hover { text-decoration:underline; }
    header { display:flex; justify-content:space-between; gap:16px; align-items:flex-start; }
    h1 { margin:0 0 6px; font-size: 22px; }
    .sub { margin:0; color:var(--muted); }
    .toolbar { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top: 14px; }
    .input { border:1px solid var(--border); border-radius:10px; padding:10px 12px; min-width:260px; font-size:0.95rem; background:#fff; }
    .pill { border:1px solid var(--border); background:#fff; padding:6px 10px; border-radius:999px; font-size:0.9rem; cursor:pointer; }
    .pill[aria-pressed="true"] { border-color:#93c5fd; background:#eff6ff; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:14px; margin-top:14px; }
    .card { border:1px solid var(--border); border-radius:12px; padding:14px 16px; background:var(--card); }
    .card h2 { margin:0 0 6px; font-size:1.05rem; }
    .card p { margin:0 0 10px; color:var(--muted); }
    .meta { color:var(--muted); font-size: 13px; }
  </style>
</head>
<body>
  <main>
    <header>
      <div>
        <h1 id="siteTitle">OpenClaw Pages</h1>
        <p class="sub" id="siteSubtitle">문서/정리 HTML 모음. 공유할 때는 이 사이트의 URL만 보내면 됨.</p>
      </div>
      <div class="meta" style="text-align:right;">
        <div>repo: <a id="repoLink" href="https://github.com/samdasuu/openclaw-pages">https://github.com/samdasuu/openclaw-pages</a></div>
        <div class="sub">base: <a id="baseLink" href="./">https://samdasuu.github.io/openclaw-pages/</a></div>
      </div>
    </header>

    <div class="toolbar">
      <input class="input" id="q" placeholder="검색 (제목/요약/카테고리)" />
      <div id="catBar" style="display:flex; gap:8px; flex-wrap:wrap;"></div>
    </div>

    <div id="status" class="meta" style="margin-top:10px;"></div>
    <div class="grid" id="grid"></div>

    <script>
      async function boot() {
        const res = await fetch('./pages.json', {cache:'no-store'});
        const data = await res.json();
        const pages = data.pages || [];

        const q = document.getElementById('q');
        const grid = document.getElementById('grid');
        const status = document.getElementById('status');
        const catBar = document.getElementById('catBar');

        const cats = Array.from(new Set(pages.map(p => p.category).filter(Boolean)));
        const state = { cat: 'ALL', q: '' };

        function mkPill(label, value) {
          const b = document.createElement('button');
          b.className = 'pill';
          b.textContent = label;
          b.dataset.value = value;
          b.setAttribute('aria-pressed', value === state.cat ? 'true' : 'false');
          b.onclick = () => {
            state.cat = value;
            render();
            for (const el of catBar.querySelectorAll('button')) {
              el.setAttribute('aria-pressed', el.dataset.value === state.cat ? 'true' : 'false');
            }
          };
          return b;
        }

        catBar.appendChild(mkPill('ALL', 'ALL'));
        for (const c of cats) catBar.appendChild(mkPill(c, c));

        q.oninput = () => { state.q = q.value.trim().toLowerCase(); render(); };

        function render() {
          grid.innerHTML = '';
          let filtered = pages;
          if (state.cat !== 'ALL') filtered = filtered.filter(p => p.category === state.cat);
          if (state.q) {
            filtered = filtered.filter(p => {
              const hay = `${p.title||''} ${p.description||''} ${p.category||''} ${p.date||''} ${p.id||''}`.toLowerCase();
              return hay.includes(state.q);
            });
          }
          status.textContent = `${filtered.length} / ${pages.length} 보고서`;
          for (const p of filtered) {
            const card = document.createElement('div');
            card.className = 'card';
            const h2 = document.createElement('h2');
            const a = document.createElement('a');
            a.href = `./${p.href}`;
            a.textContent = p.title;
            h2.appendChild(a);
            const desc = document.createElement('p');
            desc.textContent = p.description || '';
            const meta = document.createElement('div');
            meta.className = 'meta';
            meta.textContent = `${p.category || ''} · ${p.date || ''} · ${p.id || ''}`;
            card.appendChild(h2);
            card.appendChild(desc);
            card.appendChild(meta);
            grid.appendChild(card);
          }
        }

        render();
      }
      boot();
    </script>
  </main>
</body>
</html>
